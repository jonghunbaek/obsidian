---
플랫폼: 프로그래머스
문제 이름: 주차 요금 계산
알고리즘:
tags:
date: 2025-11-19
aliases:
복습 풀이: 251119(O), 251126(O)
---
# 1차 풀이
```java
import java.util.*;
// 1. 구현 문제
// 2. 기본 요금 + [(주차시간 - 기본시간) / 단위시간] * 단위 요금
//  2-1. fees[0] = 기본시간, fees[1] = 기본 요금, fees[2] = 단위 시간, fees[3] = 단위 요금
// 3. records는 Map<Integer, int[]>로 입/출차 시간 기록
// 4. 이후 공식에 따라 주차요금을 계산하여 차량 번호가 작은 순으로 요금 반환
class Solution {
    public int[] solution(int[] fees, String[] records) {
        return toMap(records).entrySet().stream()
            .sorted((e1, e2) -> e1.getKey().compareTo(e2.getKey()))
            .mapToInt(entry -> calculate(entry.getValue(), fees))
            .toArray();
    }
    
    private Map<String, Double> toMap(String[] records) {
        Map<String, List<Integer>> result = new HashMap<>();
        
        for(String record : records) {
            String[] split = record.split(" ");
            int time = toMinutes(split[0]);
            String carNumber = split[1];
            
            List<Integer> times = result.getOrDefault(carNumber, new ArrayList<>());
            times.add(time);
            result.put(carNumber, times);
        }
        
        Map<String, Double> parkingTimes = new HashMap<>();
        for (String key : result.keySet()) {
            List<Integer> times = result.get(key);
            double totalTime = 0;
            for (int i = 0; i < times.size(); i += 2) {
                double next = i + 1 == times.size() ? 23 * 60 + 59 : times.get(i + 1);
                totalTime += next - times.get(i);                    
            }
            
            parkingTimes.put(key, totalTime);
        }
        
        return parkingTimes;
    }
    
    // 2. 기본 요금 + [(주차시간 - 기본시간) / 단위시간] * 단위 요금
    private int calculate(double parkingTime, int[] fees) {
        int basicTime = fees[0];
        int basicPrice = fees[1];
        int perMinute = fees[2];
        int perPrice = fees[3];
        
        if (parkingTime <= basicTime) return basicPrice;
        
        return basicPrice + (int) Math.ceil((parkingTime - basicTime) / perMinute) * perPrice;
    }
    
    private int toMinutes(String time) {
        String[] split = time.split(":");
        int hour = Integer.parseInt(split[0]) * 60;
        int minutes = Integer.parseInt(split[1]);
        
        return hour + minutes;
    }
}
```
총 40분소요(33 + 7)
- 첫 풀이 때, 구조는 모두 잡아두고
- 두번째 풀이 때, 오류 수정
시간 제한을 염두에 두고 푸니 확실히 깔끔하게 풀리지 않음
Math.ceil()을 이용해 올림을 할 때, 파라미터 값이 double이었어야 함

# 2차 풀이
```java
import java.util.*;
import java.util.stream.Collectors;

class Solution {
    public int[] solution(int[] fees, String[] records) {
        Map<String, Set<Integer>> record = new HashMap<>();
        for (String r : records) {
            String[] split = r.split(" ");
            int time = toMinutes(split[0]);
            String carNumber = split[1];

            Set<Integer> times = record.getOrDefault(carNumber, new HashSet<>());
            times.add(time);
            record.put(carNumber, times);
        }

        return record.entrySet().stream()
                .sorted(Comparator.comparing(Map.Entry::getKey))
                .mapToInt(entry -> calculateTotalTime(entry.getValue()))
                .map(totalTime -> calculateFee(totalTime, fees))
                .toArray();
    }

    private int calculateFee(int totalTime, int[] fees) {
        int defaultTime = fees[0];
        int defaultFee = fees[1];
        int perTime = fees[2];
        int perFee = fees[3];

        if (totalTime <= defaultTime) return defaultFee;

        return (int) (defaultFee + Math.ceil(((double) totalTime - defaultTime) / perTime) * perFee);
    }

    private int calculateTotalTime(Set<Integer> target) {
        List<Integer> times = target.stream()
                .sorted()
                .collect(Collectors.toList());

        int totalTime = 0;
        for (int i = 0; i < times.size() - 1; i += 2) {
            totalTime += times.get(i + 1) - times.get(i);
        }

        if (times.size() % 2 != 0) {
            totalTime += (23 * 60 + 59) - times.get(times.size() - 1);
        }

        return totalTime;
    }

    private int toMinutes(String time) {
        String[] split = time.split(":");

        return Integer.parseInt(split[0]) * 60 + Integer.parseInt(split[1]);
    }
}
```