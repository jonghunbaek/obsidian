로그는 서버의 상태와 동작 정보를 시간 경과에 따라 기록된 결과물이다. 이를 활용해 여러 문제를 해결하는 데 도움을 준다. 
메트릭은 특정 시점의 시스템의 성능과 상태에 대한 정보다. 이를 활용해 시스템의 현재 상태, 리소스의 정보를 알 수 있다. 

### 로그와 메트릭을 활용한 경험이 있나요?
Prometheus, Grafana를 활용해 서버 메트릭을 수집화하여 대시보드로 시각화했습니다.
더불어, Promtail, Loki를 활용해 로그를 수집했습니다. 

### 어떤 메트릭을 수집했고 왜 수집했나요?
CPU, 메모리, JVM의 힙 사용량 등을 수집했습니다. 
현재 서비스가 정상 작동하는지 확인하기 위해 수집했습니다. 
CPU 사용량이 비정상적으로 높게 유지된다면, 특정 프로세스의 무한 루프, 비효율적인 연산을 의심해볼 수 있습니다. 
메모리 사용량이 계속해서 증가하고 반환되지 않는다면, 메모리 누수를 의심해볼 수 있습니다. 
JVM 힙 사용량은 GC가 정상적으로 작동하는지, Java 애플리케이션에서 메모리 누수는 없는지를 확인해볼 수 있습니다. 


### 로그와 메트릭 수집에 활용한 도구들은 서로 어떤 관계인가요?
Spring Boot를 사용해서 진행했던 프로젝트를 기반으로 설명하겠습니다.
Spring Boot에선 Spring Actuator라는 라이브러리를 통해 JVM, 시스템의 메트릭을 엔드 포인트로 제공합니다.
Prometheus에선 일정 주기로 Spring Actuator 엔드 포인트로 요청을 보내 메트릭 정보를 pull해옵니다.
Grafana에선 Prometheus에서 수집한 정보를 바탕으로 사용자가 보기 편리하게 대시보드 형태로 데이터를 시각화합니다.

로그의 경우, Promtail에 로그가 저장되는 위치를 설정해주면 주기적으로 로그를 가져와 파싱합니다.
수집된 로그 라인에 인덱싱할 메타데이터(라벨)을 붙여 Loki로 주기적으로 push하여 로그 데이터를 전송합니다.
Loki는 로그 내용을 전부 인덱싱하는 대신, 라벨만 인덱싱하여 저장합니다. 이를 통해 스토리지 비용을 낮추고 인덱싱 속도를 높이는 장점을 얻습니다.

### 말씀해주신 스택이 다른 로그 수집 시스템(ELK Stack)에 비해 갖는 장점은 무엇인가요?
Loki의 가장 큰 장점은 비용 효율성이 좋은 것입니다. 사용자가 지정한 라벨만 인덱싱하기 때문에 저장 공간, 인덱싱에 필요한 리소스가 훨씬 적게 듭니다.
또한 Prometheus와 라벨링 시스템을 공유하므로 메트릭과 로그를 유기적으로 연결하여 분석하기 용이합니다. 
다만, 로그 내용 전체에 대한 텍스트 검색 성능은 ELK에 비해 떨어집니다. 