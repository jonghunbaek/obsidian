JPA의 아이디 생성 전략은 먼저 수동 할당, 자동 할당으로 구분할 수 있습니다.
수동 할당의 경우 @Id 어노테이션만 붙이고 프로그래머가 직접 할당하면 됩니다. 다만, 아이디 생성 방식 설계에 대한 깊은 고민이 필요합니다.

자동 할당의 경우 @GeneratedValue 어노테이션을 활용하여 사용할 수 있습니다.
자동 할당은 크게 네 개의 방식으로 나뉩니다.
첫째, AUTO 전략은 DB Dialect에 따라 IDENTITY, SEQUENCE, TABLE 중 하나를 자동으로 선택합니다. 
둘째, IDENTITY 전략은 아이디 생성을 DB에 위임하는 전략입니다. 때문에 DB에서 실제로 insert 된 이후에 id를 알 수 있습니다. 
셋째, SEQUENCE 전략은 시퀀스 키 생성 전략을 지원하는 DB에서 사용할 수 있는 전략입니다. **inset 이전에 jpa가 먼저 시퀀스를 조회하여 id값을 알아온 후에 영속성 컨텍스트에 저장합니다. 그 후 트랜잭션 커밋 시점에 insert 쿼리를 보냅니다.**
넷째, TABLE 전략은 키 생성 전용 테이블을 만들어 시퀀스를 흉내내는 전략입니다. 

### 여러 전략이 있는데 언제 각 전략의 장, 단점에 대해 알려주세요.
먼저, 수동 할당의 경우 앞서 말씀드린 것처럼 사전에 아이디 생성 방식에 대한 설계가 필요합니다. 잘못 설계할 경우 PK의 저장 용량이 매우 커질 수 있으며, 불규칙할 경우 유니크함을 보장하지 못할수도 있습니다.

자동 할당의 경우 id를 생성하는 주체와 시점에 따라 명확한 차이를 가집니다. 특히 JPA의 쓰기 지연 및 배치 처리 기능의 동작 여부가 가장 큰 차이입니다. 

- **IDENTITY 전략**
	- 설정이 직관적이고 간편하며 MySQL, PostgreSQL 등 널리 쓰이는 DB에서 보편적으로 지원
	- 성능 저하를 유발할 가능성이 존재함
		- 쓰기 지연이 안됨, 따라서 bulk insert가 불가능
- **SEQUENCE 전략**
	- 성능 최적화에 유리함. IDENTITY 전략과 반대되는 장점
	- 오라클 등 시퀀스 키 생성 전략을 지원하는 DB에서만 사용 가능
- **TABLE 전략**
	- DBMS 종류에 구애받지 않아 이식성이 좋음
	- 성능이 가장 좋지 않아 추천하지 않음. ID 채번마다 키 생성용 테이블에 select, update 쿼리가 발생하기 때문임

이에 따라 가장 권장하는 전략은 SEQUENCE입니다. 다만 프로젝트가 작은 경우엔 IDENTITY 전략 또한 나쁘지 않은 선택입니다. 

### SEQUENCE 전략의 `allocationSize` 옵션은 왜 중요한가요? 구체적으로 어떻게 동작하나요?
이 전략을 직접 써본적은 없습니다. 다만 예전에 공부를 하며 allocationSize가 성능 최적화에 가장 중요한 키포인트임을 알게 됐습니다.
- allocationSize가 1이라면 엔티티를 저장할 때마다 id를 얻기 위해 db시퀀스 조회 통신이 일어남
- 50이라면 최초에 시퀀스를 한 번 조회하여 db의 시퀀스 값을 증가 시킨뒤에 1~50의 값을 메모리에 저장
- 51번째 때 다시 시퀀스 조회가 일어나게됨
### 그렇다면 ID 수동 할당 전략은 언제, 왜 사용해야 할까요?
수동 할당의 경우 PK의 의미가 비즈니스적으로 매우 중요한 경우에 사용하는 것으로 알고 있습니다. 
예를 들어, 회원의 ID로 이메일 주소를 사용하거나, 여러 서버에서 동시에 생성되어도 중복되지 않아야 하는 고유 식별자가 필요할 때 UUID를 생성해 할당하는 경우가 있습니다. 